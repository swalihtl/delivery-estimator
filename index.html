<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Delivery Date Checker</title>

<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
  }

  .delivery-box {
    border: 1px solid #e5e5e5;
    padding: 16px;
    max-width: 420px;
  }

  h4 {
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 10px;
  }

  .row {
    display: flex;
    gap: 8px;
  }

  input {
    flex: 1;
    padding: 10px;
    border: 1px solid #ccc;
    font-size: 14px;
  }

  button {
    padding: 0 18px;
    background: black;
    color: white;
    border: none;
    font-size: 14px;
    cursor: pointer;
  }

  .info {
    margin-top: 10px;
    font-size: 14px;
    line-height: 1.6;
  }

  .green {
    color: #2e7d32;
    font-weight: 500;
  }
</style>
</head>

<body>

<div class="delivery-box" id="box">
  <h4>Check your delivery date</h4>

  <div class="row">
    <input
      id="pincode"
      placeholder="Enter pincode to check delivery date"
      maxlength="6"
    />
    <button onclick="checkDelivery()">CHECK</button>
  </div>

  <div id="result" class="info"></div>
</div>

<script>
function sendHeight() {
  const height = document.body.scrollHeight;
  parent.postMessage({ iframeHeight: height }, "*");
}

function checkDelivery() {
  const pin = document.getElementById("pincode").value;

  if (!/^\d{6}$/.test(pin)) {
    document.getElementById("result").innerHTML =
      "Please enter a valid 6-digit pincode.";
    sendHeight();
    return;
  }

  const p = Number(pin);

  const now = new Date();
  const ist = new Date(
    now.toLocaleString("en-US", { timeZone: "Asia/Kolkata" })
  );

  const hour = ist.getHours();
  const dispatchDate = new Date(ist);
  if (hour >= 18) dispatchDate.setDate(dispatchDate.getDate() + 1);

  let minDays = 5, maxDays = 7;

  if (p >= 560001 && p <= 560100) {
    minDays = maxDays = 3;
  } else if (p >= 670000 && p <= 695999) {
    minDays = 2; maxDays = 3;
  } else if (
    (p >= 600000 && p <= 643999) ||
    (p >= 560000 && p <= 591999) ||
    (p >= 500000 && p <= 535999) ||
    (p >= 400000 && p <= 444999)
  ) {
    minDays = 3; maxDays = 4;
  }

  const start = new Date(dispatchDate);
  start.setDate(dispatchDate.getDate() + minDays);

  const end = new Date(dispatchDate);
  end.setDate(dispatchDate.getDate() + maxDays);

  const options = { day: "numeric", month: "long" };

  document.getElementById("result").innerHTML = `
    <p>ðŸšš Delivery by <strong>
      ${start.toLocaleDateString("en-IN", options)}
      ${minDays !== maxDays ? " or " + end.toLocaleDateString("en-IN", options) : ""}
    </strong></p>
    <p>ðŸ“¦ Dispatch: ${dispatchDate.toDateString()}</p>
    <p class="green">Free shipping all over India</p>
  `;

  sendHeight();
}

window.onload = sendHeight;
</script>

</body>
</html>
